FROM golang:1.22-alpine

# Install dependencies (optional tools like git, bash)
RUN apk add --no-cache git bash

# Set working directory
WORKDIR /app

# Copy go.mod and go.sum first (better caching)
COPY ./src/go.mod ./src/go.sum ./
RUN go mod download

# Copy source code (in dev, usually mounted instead of copied)
COPY ./src .

# Swagger docs
RUN go install github.com/swaggo/swag/cmd/swag@latest
RUN swag init --output docs

# Expose app port
EXPOSE 8080

# Run the app (default dev run)
CMD ["go", "run", "."]
